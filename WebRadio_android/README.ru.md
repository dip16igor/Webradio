[Read in English](README.md)

# Android-пульт для WebRadio

Это Android-приложение, которое служит пультом дистанционного управления для самодельного интернет-радио на базе ESP32. Оно использует протокол MQTT для связи с аппаратным устройством, позволяя пользователям управлять воспроизведением, станциями и устанавливать будильники.

## Возможности

- **Пульт ДУ**: Управление основными функциями, такими как Питание, Громкость +/-, Канал +/-, и Таймер сна.
- **Предустановленные станции**: Выбор из предопределенного списка любимых радиостанций.
- **Управление будильником**: Установка и отключение будильников прямо из приложения.
- **Поддержка нескольких устройств**: Переключение управления между двумя разными радио-устройствами (например, "Kusa" и "Chelyabinsk").
- **Статус в реальном времени**: Интерфейс отображает текущую станцию, название трека, уровень громкости и статус подключения к MQTT.
- **Сохранение настроек**: Приложение запоминает последнее выбранное радио-устройство с помощью Jetpack DataStore.

## Скриншоты

_(Добавьте сюда скриншоты интерфейса приложения)_

## Стек технологий

- **Язык**: [Kotlin](https://kotlinlang.org/)
- **UI**: [Jetpack Compose](https://developer.android.com/jetpack/compose)
- **Асинхронное программирование**: [Kotlin Coroutines & Flow](https://developer.android.com/kotlin/coroutines)
- **Сеть**: [Paho MQTT Client for Android](https://www.eclipse.org/paho/index.php?page=clients/android/index.php)
- **Хранение данных**: [Jetpack DataStore](https://developer.android.com/topic/libraries/architecture/datastore)
- **Архитектура**: Простая, управляемая состоянием архитектура в рамках одной Activity.

## Установка и настройка

1.  **Склонируйте репозиторий**:

    ```bash
    git clone <repository-url>
    ```

2.  **Настройте учетные данные**:
    Проект использует файл `Secrets.kt` для хранения учетных данных MQTT, который исключен из системы контроля версий. Вам необходимо создать этот файл самостоятельно.

    Создайте новый файл по пути `app/src/main/java/com/dip16/webradio/Secrets.kt` со следующим содержимым:

    ```kotlin
    package com.dip16.webradio

    /**
     * This file contains the secret credentials for the application.
     * It should be added to .gitignore to prevent committing secrets.
     */
    object Secrets {
        const val MQTT_BROKER_URL = "tcp://YOUR_BROKER_IP:1883"
        const val MQTT_LOGIN = "YOUR_MQTT_LOGIN"
        const val MQTT_PASSWORD = "YOUR_MQTT_PASSWORD"
    }
    ```

    Замените значения-заглушки на ваши реальные данные MQTT-брокера.

3.  **Сборка проекта**:
    Откройте проект в Android Studio и выполните сборку.

## Протокол MQTT

Приложение общается с аппаратным устройством, идентифицируемым по `radioName` (например, "WebRadio1" или "WebRadio2").

### Топики, публикуемые приложением (Приложение -> Устройство)

- **Топик**: `Home/{radioName}/Action`
- **Сообщения**:
  - `?`: Запросить текущий статус у устройства.
  - `b1`: Переключить питание.
  - `b2`: Активировать таймер сна.
  - `b3`: Следующий канал.
  - `b4`: Предыдущий канал.
  - `vol+`: Увеличить громкость.
  - `vol-`: Уменьшить громкость.
  - `s<секунды>`: Установить будильник. Сообщение содержит общее количество секунд с полуночи (например, `s19800` для 5:30 утра).
  - `sAlarm OFF`: Отключить будильник.
  - `<station_url>`: Включить определенную станцию по ее URL (например, `http://silverrain.hostingradio.ru/silver128.mp3`).

### Топики, на которые подписывается приложение (Устройство -> Приложение)

Приложение подписывается на несколько топиков для получения обновлений статуса от устройства в реальном времени.

- `Home/{radioName}/State`: Текущее состояние питания (например, "Power ON", "Power OFF").
- `Home/{radioName}/Station`: Название текущей радиостанции.
- `Home/{radioName}/Title`: Название текущего трека.
- `Home/{radioName}/Volume`: Текущий уровень громкости.
- `Home/{radioName}/Alarm`: Текущая настройка будильника (в секундах с полуночи или строка "Alarm OFF").
- `Home/{radioName}/Log`: Общие лог-сообщения от устройства для отладки.

## Как собрать проект

Вы можете собрать проект напрямую из Android Studio или использовать Gradle wrapper из командной строки:

```bash
# Собрать отладочный APK
./gradlew assembleDebug

# Собрать релизный APK
./gradlew assembleRelease
```

Сгенерированные APK-файлы будут находиться в `app/build/outputs/apk/`.

---

_*Этот README был сгенерирован на основе исходного кода проекта.*_
