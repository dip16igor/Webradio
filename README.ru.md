[Read in English](README.md)

# WebRadio: Проект самодельного IoT интернет-радио

Этот репозиторий содержит полный проект для создания системы самодельного интернет-радио, построенного на микроконтроллере ESP32 и управляемого специальным Android-приложением, веб-интерфейсом и физическими кнопками.

## Компоненты проекта

Проект разделен на четыре основные части:

### 1. Прошивка для ESP32 (`/WebRadio_ESP32_S3`)

Это ядро радиоприемника, работающее на ESP32. Оно отвечает за подключение к интернету, потоковое воспроизведение радиостанций и прием команд.

**Возможности:**

- Воспроизведение интернет-радио по URL-адресам.
- Удаленное управление по протоколу MQTT.
- Физические элементы управления для питания, громкости и выбора станций.
- Интеграция с Telegram-ботом для дополнительного управления и получения статусов.

Подробные инструкции по сборке аппаратной части, настройке и прошивке устройства смотрите в README в директории `WebRadio_ESP32_S3`.

### 2. Android-пульт (`/WebRadio_android`)

Нативное Android-приложение, которое служит удобным пультом дистанционного управления для радио.

**Возможности:**

- Подключается к MQTT-брокеру для отправки команд и получения обновлений статуса в реальном времени.
- Выбор из списка предустановленных радиостанций.
- Управление питанием, громкостью и каналами.
- Установка и управление будильниками.
- Переключение между управлением разными радио-устройствами.

Инструкции по установке, настройке и сборке приложения находятся в README в директории `WebRadio_android`.

### 3. Веб-интерфейс (`/WebRadio_web`)

Веб-пульт для управления радио, доступный с любого устройства с веб-браузером.

**Возможности:**

- Отображение статуса в реальном времени: текущая станция, трек, громкость и т.д.
- Управление питанием, громкостью и выбор станций.
- Установка и отмена будильников.
- Адаптивный интерфейс, который работает на настольных и мобильных браузерах.

Инструкции по установке и использованию находятся в README в директории `WebRadio_web`.

### 4. Утилиты на Python (`/WebRadio_python_utils`)

Набор вспомогательных скриптов для управления списками радиостанций.

**Возможности:**

- `webradio.py`: Консольный радиоплеер, использующий VLC.
- `convert_txt_to_json.py`: Конвертирует простой текстовый файл с URL-адресами станций в JSON-список для плееров.
- `sort_txt.py`: Сортирует и удаляет дубликаты из списка станций.

## Архитектура системы

Компоненты взаимодействуют по локальной сети с использованием легковесного протокола обмена сообщениями MQTT. Для передачи сообщений между интерфейсами управления (Android-приложение, веб-интерфейс) и ESP32-радио требуется центральный MQTT-брокер.

```
+--------------------+         +----------------+         +-----------------+
|                    |         |                |         |                 |
|  Android-пульт     |         |                |         |   ESP32-радио   |
|   (Приложение)     | <-----> |  MQTT-брокер   | <-----> |   (Устройство)  |
|                    |         |                |         |                 |
+--------------------+         |(напр. Mosquitto)|         +-----------------+
        ^                      |                |                      ^
        |                      +----------------+                      |
        |                                                              |
        +--------------------------------------------------------------+
        |
+--------------------+
|                    |
|  Веб-интерфейс     |
|     (Браузер)      |
|                    |
+--------------------+
```

- **Android-приложение** и **Веб-интерфейс** публикуют команды (например, сменить станцию, увеличить громкость) в определенные MQTT-топики.
- **ESP32-радио** подписывается на эти топики, слушает команды и выполняет их.
- **ESP32-радио** также публикует свой статус (например, текущую станцию, название трека, громкость) в другие топики.
- **Android-приложение** и **Веб-интерфейс** подписываются на топики статуса для отображения информации в реальном времени.

## Начало работы

Чтобы запустить всю систему, вам потребуется:

1.  **Настроить MQTT-брокер**: Установите и запустите MQTT-брокер, например Mosquitto, на устройстве в вашей локальной сети (например, на Raspberry Pi или вашем компьютере).
2.  **Собрать и прошить устройство**:
    - Перейдите в каталог `WebRadio_ESP32_S3`.
    - Настройте учетные данные для Wi-Fi и MQTT-брокера в исходном коде.
    - Соберите и загрузите прошивку на ваше устройство ESP32.
3.  **Настроить интерфейс(ы) управления**:
    - **Для Android-приложения**:
        - Откройте проект `WebRadio_android` в Android Studio.
        - Создайте файл `Secrets.kt` и добавьте учетные данные вашего MQTT-брокера.
        - Соберите проект и установите APK на ваше Android-устройство.
    - **Для веб-интерфейса**:
        - Перейдите в каталог `WebRadio_web`.
        - Установите зависимости с помощью `npm install`.
        - Настройте ваш MQTT-брокер и секретный токен в файле `.env`.
        - Запустите сервер с помощью `node server.js`.

После того как все компоненты будут настроены и запущены, приложение и веб-интерфейс смогут подключиться к брокеру и управлять радио.


# WebRadio: Проект самодельного IoT интернет-радио

Этот репозиторий содержит полный проект для создания системы самодельного интернет-радио, построенного на микроконтроллере ESP32 и управляемого специальным Android-приложением через MQTT.

## Компоненты проекта

Проект разделен на две основные части:

### 1. Прошивка для ESP32 (`/WebRadio_STM32_S3`)

Это ядро радиоприемника, работающее на ESP32. Оно отвечает за подключение к интернету, потоковое воспроизведение радиостанций и прием команд.

**Возможности:**

- Воспроизведение интернет-радио по URL-адресам.
- Удаленное управление по протоколу MQTT.
- Физические элементы управления с использованием поворотного энкодера с кнопкой (благодаря библиотеке `EncButton`).
- (Вероятно) Интеграция с Telegram-ботом для дополнительного управления и получения статусов (на основе наличия библиотеки `FastBot`).

Подробные инструкции по сборке аппаратной части, настройке и прошивке устройства смотрите в **соответствующей директории**. Для нее следует создать отдельный README.

### 2. Android-пульт (`/WebRadio_android`)

Нативное Android-приложение, которое служит удобным пультом дистанционного управления для радио.

**Возможности:**

- Подключается к MQTT-брокеру для отправки команд и получения обновлений статуса в реальном времени.
- Выбор из списка предустановленных радиостанций.
- Управление питанием, громкостью и каналами.
- Установка и управление будильниками.
- Переключение между управлением разными радио-устройствами.

Инструкции по установке, настройке и сборке приложения находятся в **README для Android-приложения**.

## Архитектура системы

Компоненты взаимодействуют по локальной сети с использованием легковесного протокола обмена сообщениями MQTT. Для передачи сообщений между Android-приложением и ESP32-радио требуется центральный MQTT-брокер.

```
+--------------------+         +----------------+         +-----------------+
|                    |         |                |         |                 |
|  Android-пульт     | <-----> |  MQTT-брокер   | <-----> |   ESP32-радио   |
|   (Приложение)     |         |(напр. Mosquitto)|         |   (Устройство)  |
|                    |         |                |         |                 |
+--------------------+         +----------------+         +-----------------+
```

- **Android-приложение** публикует команды (например, сменить станцию, увеличить громкость) в определенные MQTT-топики.
- **ESP32-радио** подписывается на эти топики, слушает команды и выполняет их.
- **ESP32-радио** также публикует свой статус (например, текущую станцию, название трека, громкость) в другие топики.
- **Android-приложение** подписывается на топики статуса для отображения информации в реальном времени.

## Начало работы

Чтобы запустить всю систему, вам потребуется:

1.  **Настроить MQTT-брокер**: Установите и запустите MQTT-брокер, например Mosquitto, на устройстве в вашей локальной сети (например, на Raspberry Pi или вашем компьютере).
2.  **Собрать и прошить устройство**:
    - Перейдите в каталог `WebRadio_STM32_S3`.
    - Настройте учетные данные для Wi-Fi и MQTT-брокера в исходном коде.
    - Соберите и загрузите прошивку на ваше устройство ESP32.
3.  **Собрать и установить Android-приложение**:
    - Откройте проект `WebRadio_android` в Android Studio.
    - Создайте файл `Secrets.kt` и добавьте учетные данные вашего MQTT-брокера.
    - Соберите проект и установите APK на ваше Android-устройство.

После того как все компоненты будут настроены и запущены, приложение сможет подключиться к брокеру и управлять радио.
